<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tarjeta de Presentación</title>

    <script>
    class presentationCardIepz extends HTMLElement {
        constructor(name, lastname, email){
            //super se usa para llamar al constructor de HTMLElement
            super();
            this.shadow = this.attachShadow({mode: 'open'});
            this.divName = document.createElement('div');
            this.divLastName = document.createElement('div1');
            this.divEmail = document.createElement('div2');
            this.shadow.appendChild(this.divName);
            this.shadow.appendChild(this.divLastName);
            //this.shadow.appendChild(this.divEmail);
        }

        connectedCallback(){
        }


        attributeChangedCallback(nameAttribute, oldValue, newValue) {
            console.log('Cambian propiedades', nameAttribute, oldValue, newValue);
            this.divEmail.textContent = newValue;

            let pos = this.divEmail.textContent.indexOf('@');
            console.log('Posición de @: ' + pos);
            //El slice parte una cadena a partir de la posición indicada
            let verificaemail = this.divEmail.textContent.slice(pos + 1);
            console.log('Dominio del email: ' + verificaemail);

            if(nameAttribute === 'name'){
                this.divName.textContent = newValue;
                if(this.divName.textContent === 'Eunice'){
                    this.divName.textContent = 'Soy yo: ' + this.divName.textContent;
                } else { 
                    this.divName.textContent = 'Hola ' + this.divName.textContent;
                }
            }   
        
            if(nameAttribute === 'email') {
                this.divLastName.textContent = newValue;
                if(verificaemail === 'gmail.com'){
                    this.divLastName.textContent = 'Perteneces a Skynet: ' + this.divEmail.textContent ;
                }else{
                    this.divLastName.textContent = 'El correo es: ' + this.divEmail.textContent + ". No pertenece a Skynet";
                }
            }
        }
        
        static get observedAttributes() {
            return ['name', 'lastName', 'email'];
        }
    }
    console.log('Presentation Card Created');
    customElements.define('presentation-card-iepz', presentationCardIepz);
    </script>

</head>
<body>
    <presentation-card-iepz name = 'Eunice' lastName = 'Pino' email = 'idzi@gmail.com'></presentation-card-iepz>
</body>
</html>